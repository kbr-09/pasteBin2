<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>{{ title }}</title>

  <!-- CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="container">

    <div class="header">
      <h1>HOMElab TEXTshare</h1>
      <p>Fast (not really), secure (daddy issues though)</p>
    </div>

    {% if message %}
      <div class="alert alert-{{ message_type }}">{{ message }}</div>
    {% endif %}

    <div class="paste-form">
      <h2>New Paste</h2>

      <form method="post" action="{{ url_for('create_paste') }}">
        <div class="form-group">
          <label for="title">Title (optional)</label>
          <input id="title" name="title" type="text" placeholder="Enter a title">
        </div>

        <div class="form-group">
          <label for="language">Language</label>
          <select id="language" name="language">
            <option value="auto">Auto-detect</option>
            <option value="text">Plain Text</option>
            <option value="python">Python</option>
            <option value="javascript">JavaScript</option>
            <option value="html">HTML</option>
            <option value="css">CSS</option>
            <option value="json">JSON</option>
            <option value="markdown">Markdown</option>
          </select>
        </div>

        <div class="form-group">
          <label for="content">Content</label>
          <textarea id="content" name="content" required
            placeholder="Paste your code or text here..."></textarea>
        </div>

        <button class="btn btn-submit" type="submit">Create Paste</button>
      </form>
    </div>

    {% if pastes %}
      {% for paste in pastes %}
        <div class="paste-item">

          <div class="paste-header">
            <div>
              <h3>{{ paste.title or 'Untitled Paste' }}</h3>
              <div class="meta">
                ID: {{ paste.id }} •
                {{ paste.created_at }} •
                {{ paste.language or 'Unknown' }} •
                {{ paste.size }} chars
              </div>
            </div>

            <div class="actions">
              <a class="btn btn-sm btn-secondary"
                 href="{{ url_for('view_paste', paste_id=paste.id) }}">
                View
              </a>

              <a class="btn btn-sm btn-secondary"
                 href="{{ url_for('raw_paste', paste_id=paste.id) }}">
                Raw
              </a>

              <a class="btn btn-sm btn-danger"
                 href="{{ url_for('delete_paste', paste_id=paste.id) }}"
                 onclick="return confirm('Delete this paste?')">
                Delete
              </a>
            </div>
          </div>

          <div class="content" id="content-{{ paste.id }}">
            {{ paste.content[:200] }}{% if paste.content|length > 200 %}...{% endif %}

            <button class="copy-btn"
        onclick="copyToClipboard('{{ paste.id }}', this)">
  <img src="{{ url_for('static', filename='resources/copy.svg') }}"
       alt="Copy"
       class="copy-icon path">
</button>

          </div>

        </div>
      {% endfor %}

      {% if total_pages > 1 %}
        <div class="pagination">

          {% if page > 1 %}
            <a href="{{ url_for('index', page=page-1) }}">Previous</a>
          {% endif %}

          {% for pg in range(1, total_pages + 1) %}
            {% if pg == page %}
              <span class="current">{{ pg }}</span>
            {% else %}
              <a href="{{ url_for('index', page=pg) }}">{{ pg }}</a>
            {% endif %}
          {% endfor %}

          {% if page < total_pages %}
            <a href="{{ url_for('index', page=page+1) }}">Next</a>
          {% endif %}

        </div>
      {% endif %}
    {% else %}
      <p style="color:#ededed;">No pastes yet.</p>
    {% endif %}

  </div>

  <!-- JS -->
  <script src="{{ url_for('scripts', filename='app.js') }}"></script>
</body>
</html>
